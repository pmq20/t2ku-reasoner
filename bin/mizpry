#!/usr/bin/env ruby

$0 = 'mizpry'

begin
  require File.expand_path('../../lib/mizar.rb',__FILE__)
rescue LoadError
  require 'rubygems'
  require 'mizar'
end


opts = Slop.parse(:help => true, :multiple_switches => false) do
  banner %{Usage: mizpry [OPTIONS]
Start the Mizar console.
See: `https://www.t2ku.org` for more information.
Copyright (c) 2011 Minqi Pan (P.S.V.R)
--}

  on "no-history", "Disable history loading" do
    Pry.config.history.should_load = false
  end
  
  on :e, :exec, "A line of code to execute in context before the session starts", true

end

# invoked via cli
Mizar.cli = true

# including any code passed with -e
if opts[:exec]
  exec_string = opts[:exec] + "\n"
else
  exec_string = ""
end

# Start the session (running any code passed with -e, if there is any)
Mizar.start(:input => StringIO.new(exec_string))
